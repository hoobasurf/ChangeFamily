<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snap Clone Neon - Home</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <h1>Timeline Neon</h1>

  <!-- Upload direct et bouton caméra -->
  <input type="file" id="fileInput" accept="image/*" capture="environment" class="glass-input">
  <button id="uploadBtn" class="glass-btn">Télécharger / Prendre photo</button>

  <!-- Timeline des images -->
  <div id="globalGallery"></div>
</div>

<script type="module">
import { app, storage, auth } from './firebase.js';
import { ref, uploadBytes, getDownloadURL, listAll } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-storage.js";

const fileInput = document.getElementById('fileInput');
const uploadBtn = document.getElementById('uploadBtn');
const gallery = document.getElementById('globalGallery');

const storageRef = ref(storage, 'images/');

// Fonction pour afficher les images dans la timeline
async function loadImages() {
  gallery.innerHTML = '';
  const list = await listAll(storageRef);
  for(const item of list.items) {
    const url = await getDownloadURL(item);
    const img = document.createElement('img');
    img.src = url;
    img.className = 'neon-img';
    gallery.appendChild(img);
  }
}

// Upload direct avec effet néon
uploadBtn.onclick = async () => {
  const file = fileInput.files[0];
  if(!file) return alert("Choisissez une photo !");
  const fileRef = ref(storage, 'images/' + file.name);
  await uploadBytes(fileRef, file);
  loadImages();
};

window.addEventListener('load', loadImages);
</script>
</body>
</html>
