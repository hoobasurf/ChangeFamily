<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accueil</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ===================== -->
<!-- HEADER PROFIL AVATAR   -->
<!-- ===================== -->
<div class="profile-content">

  <!-- Avatar avec cercle fixe -->
  <div class="avatar-container">
    <img src="avatar-default.png" alt="Avatar" class="profile-avatar">
  </div>

  <!-- Pseudo futuriste contour rose nÃ©on -->
  <div class="profile-pseudo" id="pseudo">MonPseudo</div>

</div>

<!-- ===================== -->
<!-- FEED POSTS            -->
<!-- ===================== -->
<div id="feed"></div>

<!-- ===================== -->
<!-- BOTTOM NAVIGATION     -->
<!-- ===================== -->
<div class="bottom-nav">
  <i class="home-icon active">ğŸ </i>
  <i class="search-icon">ğŸ”</i>
  <i class="profile-icon">ğŸ‘¤</i>
</div>

<script type="module">
// ======= SIMULATION POSTS =======
const feed = document.getElementById('feed');

// Exemple de posts pour tester
const posts = [
  { id: 1, pseudo: "Alice", avatar: "avatar1.png", url: "post1.png", type: "image", likes: 5, comments: 2 },
  { id: 2, pseudo: "Bob", avatar: "avatar2.png", url: "post2.mp4", type: "video", likes: 8, comments: 3 }
];

function renderFeed() {
  feed.innerHTML = "";
  posts.forEach(post => {
    const card = document.createElement("div");
    card.className = "post-card";
    card.innerHTML = `
      <div class="post-header">
        <img src="${post.avatar}" class="avatar" />
        <b class="poster-name">${post.pseudo}</b>
      </div>

      <div class="post-media">
        ${
          post.type === "video"
            ? `<video src="${post.url}" autoplay muted loop playsinline></video>`
            : `<img src="${post.url}" alt="post" />`
        }
      </div>

      <div class="post-actions">
        <span class="like-btn" data-id="${post.id}">â¤ï¸ <span class="like-count">${post.likes}</span></span>
        <span class="comment-btn" data-id="${post.id}">ğŸ’¬ <span class="comment-count">${post.comments}</span></span>
      </div>

      <div class="comments" id="comments-${post.id}"></div>

      <div class="comment-input" id="comment-input-${post.id}" style="display:none;">
        <input type="text" placeholder="Ã‰crire un commentaire..." />
        <button>Envoyer</button>
      </div>
    `;
    feed.appendChild(card);
  });
}

renderFeed();

// ======= INTERACTIONS LIKE / COMMENT =======
document.addEventListener("click", e => {
  // Like
  if(e.target.closest(".like-btn")){
    const btn = e.target.closest(".like-btn");
    const countEl = btn.querySelector(".like-count");
    countEl.textContent = parseInt(countEl.textContent) + 1;

    // Lancer paillettes
    launchSparkles();
  }

  // Comment input toggle
  if(e.target.closest(".comment-btn")){
    const btn = e.target.closest(".comment-btn");
    const postId = btn.dataset.id;
    const inputDiv = document.getElementById(`comment-input-${postId}`);
    inputDiv.style.display = inputDiv.style.display === "none" ? "flex" : "none";
    if(inputDiv.style.display !== "none"){
      const input = inputDiv.querySelector("input");
      setTimeout(()=>input.focus(),50);
    }
  }

  // Envoyer commentaire
  if(e.target.tagName === "BUTTON" && e.target.parentElement.classList.contains("comment-input")){
    const input = e.target.parentElement.querySelector("input");
    if(!input.value) return;
    const postId = e.target.parentElement.id.replace("comment-input-","");
    const commentDiv = document.getElementById(`comments-${postId}`);
    const pseudo = "Moi";
    const text = input.value;
    commentDiv.innerHTML += `<p><b class="pseudo">${pseudo}</b> : ${text}</p>`;
    input.value="";
    launchSparkles();
  }
});

// ======= PAILLETTES =======
function launchSparkles(){
  const sparkleCount = 30;
  for(let i=0;i<sparkleCount;i++){
    const sparkle = document.createElement("div");
    sparkle.className="sparkle";
    sparkle.style.left = Math.random()*100+"vw";
    sparkle.style.width = (4+Math.random()*6)+"px";
    sparkle.style.height = sparkle.style.width;
    sparkle.style.animationDuration = 1.5+Math.random()*2+"s";
    sparkle.style.opacity = 0.6 + Math.random()*0.4;
    sparkle.style.transform = `scale(${0.6+Math.random()*1.4})`;
    document.body.appendChild(sparkle);
    setTimeout(()=>sparkle.remove(),4000);
  }
}
</script>

</body>
</html>
