<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profil</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  .hidden { display: none; }
</style>
</head>
<body>

<div class="screen" style="text-align:center; position:relative; overflow:hidden;">
  <!-- ğŸŒŒ Particules -->
  <canvas id="particleCanvas"></canvas>

  <!-- ğŸ‘¤ Avatar avec halo -->
  <div class="avatar-wrapper">
    <div class="avatar-glow"></div>
    <img id="avatarImg" src="avatar-default.png" class="avatar-big">
  </div>

  <h2 id="pseudoDisplay">Sans pseudo</h2>
  <button class="glass-btn" onclick="openEdit()">Modifier</button>
</div>

<!-- MODAL MODIFIER -->
<div id="editModal">
  <div id="editBox">
    <h3>Modifier le profil</h3>

    <input id="pseudoInput" placeholder="Ton pseudo">
    <button id="savePseudo" class="glass-btn">ğŸ’¾ Enregistrer Pseudo</button>

    <!-- âœ… Boutons pour changer avatar -->
    <button id="chooseAvatar" class="glass-btn">ğŸ¨ Choisir un avatar</button>
    <button id="chooseGallery" class="glass-btn">ğŸ–¼ï¸ Choisir dans la photothÃ¨que</button>
    <button id="openCameraAvatar" class="glass-btn">ğŸ“¸ Prendre une photo</button>

    <!-- Fichier cachÃ© pour galerie -->
    <input type="file" id="galleryFile" accept="image/*" hidden>

    <br><br>
    <button class="glass-btn" onclick="closeEdit()">Fermer</button>
  </div>
</div>

<!-- === MODAL SÃ‰LECTEUR D'AVATAR === -->
<div id="avatarSelectorModal" class="avatar-modal hidden">
  <div class="avatar-modal-content">
    <h2>Choisis ton avatar</h2>

    <div class="avatar-preview-container">
      <img id="avatarPreview" src="avatar-default.png" alt="PrÃ©visualisation">
    </div>

    <label>ğŸ¨ Style :</label>
    <select id="diceStyle">
      <option value="avataaars">Avataaars (cartoon humain)</option>
      <option value="bottts">Bottts (robots mignons)</option>
      <option value="pixel-art">Pixel Art</option>
      <option value="croodles">Croodles (dessin fun)</option>
      <option value="identicon">Identicon (motif abstrait)</option>
    </select>

    <label>ğŸ§¬ GÃ©nÃ©rateur (seed) :</label>
    <input id="diceSeed" placeholder="Ton pseudo ou un mot au hasard">

    <button id="generateDice" class="glass-btn">ğŸ² GÃ©nÃ©rer Avatar</button>
    <button id="openRPM" class="glass-btn">ğŸŒ Ready Player Me</button>
    <button id="useSelected" class="glass-btn">âœ… Utiliser cet avatar</button>
    <button id="closeSelector" class="glass-btn">âŒ Fermer</button>
  </div>
</div>

<!-- === IFRAME READY PLAYER ME INTÃ‰GRÃ‰ === -->
<div id="rpmContainer" class="hidden">
  <iframe
    id="rpmFrame"
    allow="camera *; microphone *; clipboard-write"
    src=""
    style="width:100%; height:100%; border:none; position:fixed; top:0; left:0; z-index:99999;">
  </iframe>
</div>

<!-- DOCK -->
<div class="bottom-nav">
  <a href="home.html"><i class="fa-solid fa-house"></i></a>
  <a href="camera.html"><i class="fa-solid fa-camera"></i></a>
  <a href="chat.html"><i class="fa-solid fa-comment-dots"></i></a>
  <a href="profile.html" class="active"><i class="fa-solid fa-user"></i></a>
</div>

<!-- Script d'ouverture/fermeture modal -->
<script>
function openEdit(){ document.getElementById('editModal').style.display = "flex"; }
function closeEdit(){ document.getElementById('editModal').style.display = "none"; }
</script>

<!-- Script principal -->
<script type="module" src="profile.js"></script>

</body>
</html>
